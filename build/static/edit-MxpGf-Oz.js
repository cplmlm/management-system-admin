import{r,F as t,s as U,c as L,g as E,a as M,u as O,b as q,j as s,R as C,C as l,S as h,I as o,d as k,D as v,B as z,e as A}from"./index-Da2ZG1xd.js";import{U as B}from"./index-DfhSQg9d.js";const $=i=>{r.useImperativeHandle(i.onRef,()=>({confirm:P}));const[d]=t.useForm(),[c,j]=U.useMessage(),[x,b]=r.useState(!1),[m,u]=r.useState(""),[f,W]=r.useState([]);r.useState("");const[p,g]=r.useState();r.useEffect(()=>{w(),F()},[]);const w=()=>{const e=i.data;e.id!==void 0&&e.id!==null&&e.id!==""?I(e):u("")},I=async e=>{u(e.id),g(e.signature),e.loginPWD=await N(e==null?void 0:e.loginPWD),e.birthDate=L(e.birthDate),d.setFieldsValue(e)},N=async e=>{let a="";if(e!=null&&e!==""){const n=await E(e);(n==null?void 0:n.status)===200&&(a=n.data)}return a},P=()=>{d.validateFields().then(e=>{e.departmentName="",e.dids=[],e.roleNames=[],e.signature=p,m!==""?(e.id=m,D(e)):(e.RIDs=[],y(e))}).catch(e=>{})},y=async e=>{i.setLoading(!0);let a=await M(e);(a==null?void 0:a.status)===200&&(c.success(a.message),i.closeModal(1)),i.setLoading(!1)},D=async e=>{let a=await O(e);(a==null?void 0:a.status)===200&&(c.success(a.message),i.closeModal(2))},F=async()=>{let e=await q();(e==null?void 0:e.status)===200&&b(e.data)},R={accept:".png",beforeUpload:e=>{if(console.log(e),!(e.type==="image/png"))return c.error(`${e.name} 不是png文件`),!1;if(e.size>1024*1024)return c.error(`${e.name} 大小不能超过1M`),!1},onChange:e=>{console.log(e),S(e.file.originFileObj,a=>{console.log(a),g(a)})},fileList:f},S=(e,a)=>{const n=new FileReader;n.addEventListener("load",()=>a(n.result)),n.readAsDataURL(e)};return s.jsxs("div",{className:"form-content",children:[j,s.jsx(t,{form:d,preserve:!1,labelCol:{span:5},children:s.jsxs(C,{children:[s.jsx(l,{span:12,children:s.jsx(t.Item,{label:"医院",name:"organizationId",rules:[{required:!0,message:"医院不能为空"}],children:s.jsx(h,{showSearch:!0,placeholder:"请选择",optionFilterProp:"label",className:"select-width",fieldNames:{label:"name",value:"id"},options:i.organizationData})})}),s.jsx(l,{span:12,children:s.jsx(t.Item,{label:"姓名",name:"realName",rules:[{required:!0,message:"姓名不能为空"}],children:s.jsx(o,{className:"input-width",placeholder:"请输入"})})}),s.jsx(l,{span:12,children:s.jsx(t.Item,{label:"账号",name:"loginName",rules:[{required:!0,message:"账号不能为空"}],children:s.jsx(o,{className:"input-width",placeholder:"请输入"})})}),s.jsx(l,{span:12,children:s.jsx(t.Item,{label:"密码",name:"loginPWD",rules:[{required:!0,message:"密码不能为空"}],children:s.jsx(o.Password,{className:"input-width",placeholder:"请输入"})})}),s.jsx(l,{span:12,style:{display:m!==""?"block":"none"},children:s.jsx(t.Item,{label:"角色",name:"riDs",children:s.jsx(h,{mode:"multiple",showSearch:!0,placeholder:"请选择",optionFilterProp:"label",className:"select-width",fieldNames:{label:"name",value:"id"},options:x})})}),s.jsx(l,{span:12,children:s.jsx(t.Item,{label:"性别",name:"gender",children:s.jsx(h,{showSearch:!0,placeholder:"请选择",optionFilterProp:"label",className:"select-width",options:k("1819214015717576704",!0)})})}),s.jsx(l,{span:12,children:s.jsx(t.Item,{label:"生日",name:"birthDate",children:s.jsx(v,{className:"select-width",placeholder:"请选择"})})}),s.jsx(l,{span:12,children:s.jsx(t.Item,{label:"地址",name:"address",children:s.jsx(o,{placeholder:"请输入",className:"input-width"})})}),s.jsx(l,{span:12,children:s.jsx(t.Item,{label:"备注",name:"remark",children:s.jsx(o,{placeholder:"请输入",className:"input-width"})})}),s.jsx(l,{span:12,children:s.jsx(t.Item,{label:"对接编码",name:"name",children:s.jsx(o,{placeholder:"请输入",className:"input-width"})})}),s.jsx(l,{span:12,children:s.jsxs(t.Item,{label:"签名",name:"signatureImage",children:[s.jsx("img",{style:{height:25,width:100,paddingRight:20},src:p}),s.jsx(B,{...R,children:s.jsx(z,{icon:A("UploadOutlined"),type:"primary",children:"签名图像"})})]})})]})})]})};export{$ as default};
