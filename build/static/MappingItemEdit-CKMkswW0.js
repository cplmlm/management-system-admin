import{r as t,F as i,s as v,av as k,bF as A,bG as O,bH as P,d as G,j as a,R as z,C as r,S as p,I as h}from"./index-Da2ZG1xd.js";import{T as B}from"./index-5IsStPVA.js";const Q=l=>{t.useImperativeHandle(l.onRef,()=>({confirm:q}));const[n]=i.useForm(),[c,y]=v.useMessage(),[o,d]=t.useState(""),[g,I]=t.useState(""),[x,m]=t.useState(0),[b,f]=k.useModal(),[j,N]=t.useState([]),[T,w]=t.useState([]),[F,S]=t.useState(""),[M,C]=t.useState("");t.useEffect(()=>{D()},[]);const D=()=>{R();const e=l.data;I(e.mappingTypeId),e.id!==void 0&&e.id!==null&&e.id!==""?(d(e.id),n.setFieldsValue(e),u(e==null?void 0:e.dictionaryTypeId)):(n.setFieldsValue({serialNumber:e.serialNumber}),m(e.serialNumber),d(""))},q=()=>{n.validateFields().then(e=>{e.name=F,o!==""?(e.id=o,L(e)):(e.mappingTypeId=g,E(e))}).catch(e=>{})},E=async e=>{l.setLoading(!0);let s=await A(e);(s==null?void 0:s.status)===200&&(c.success(s.message),H()),l.setLoading(!1)},H=()=>{b.confirm({title:"是否继续创建字典？",content:"",okText:"是",cancelText:"否",centered:!0,onOk(){n.resetFields();const e=x+1;n.setFieldsValue({serialNumber:e,dictionaryTypeId:M}),m(e)},onCancel(){l.closeModal(2)}})},L=async e=>{const s=await O(e);(s==null?void 0:s.status)===200&&(c.success(s.message),l.closeModal(2))},R=async()=>{const e=await P();(e==null?void 0:e.status)===200&&N(e.data)},u=async e=>{C(e);const s=G(e,!0,!1);console.log(s),w(s)},V=(e,s)=>{console.log(e,s),S(s.label),n.setFieldsValue({mappingName:s.label})};return a.jsxs("div",{className:"form-content",children:[y,f,a.jsx(i,{form:n,preserve:!1,labelCol:{span:6},children:a.jsxs(z,{children:[a.jsx(r,{span:24,children:a.jsx(i.Item,{label:"序号",name:"serialNumber",rules:[{required:!0,message:"序号不能为空"}],children:a.jsx(B,{className:"input-width",placeholder:"请输入",min:0})})}),a.jsx(r,{span:24,children:a.jsx(i.Item,{label:"字典类型",name:"dictionaryTypeId",children:a.jsx(p,{showSearch:!0,placeholder:"请选择",optionFilterProp:"label",className:"select-width",filterOption:(e,s)=>((s==null?void 0:s.name)??"").toLowerCase().includes(e.toLowerCase()),fieldNames:{label:"name",value:"id"},onChange:e=>u(e),options:j})})}),a.jsx(r,{span:24,children:a.jsx(i.Item,{label:"字典项目",name:"code",rules:[{required:!0,message:"字典项目不能为空"}],children:a.jsx(p,{showSearch:!0,placeholder:"请选择",optionFilterProp:"label",className:"select-width",onChange:V,options:T})})}),a.jsx(r,{span:24,children:a.jsx(i.Item,{label:"对码名称",name:"mappingName",rules:[{required:!0,message:"对码项目名称不能为空"}],children:a.jsx(h,{className:"input-width",placeholder:"请输入"})})}),a.jsx(r,{span:24,children:a.jsx(i.Item,{label:"对码编码",name:"mappingCode",rules:[{required:!0,message:"对码编码不能为空"}],children:a.jsx(h,{className:"input-width",placeholder:"请输入"})})})]})})]})};export{Q as default};
