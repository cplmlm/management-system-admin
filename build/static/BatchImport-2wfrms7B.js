import{r as a,s as E,d as u,aH as k,j as e,R as H,aI as O,C as l,S as P,B as x,e as p,x as U,y as D,z as F}from"./index-Da2ZG1xd.js";import{r as M,u as T}from"./xlsx-DG2X6oDA.js";import{U as V}from"./index-DfhSQg9d.js";const G=f=>{a.useImperativeHandle(f.onRef,()=>({confirm:b}));const[i,g]=E.useMessage(),[n,I]=a.useState([]),[S,w]=a.useState(""),[d,y]=a.useState(""),[_,j]=a.useState(""),[N]=a.useState([]);a.useEffect(()=>{console.log(u("1826815637926842368"))},[]);const b=async()=>{if(console.log(n),n.length==0){i.error("没有需要导入的数据");return}let t=await k(n);(t==null?void 0:t.status)===200&&i.success(t.message)},C={accept:".xls,.xlsx,application/vnd.ms-excel",beforeUpload:t=>{if(d=="")return i.error("请选择体检项目"),!1;let r=[{}];const o=new FileReader;return o.onload=function(A){var h;const B=(h=A.target)==null?void 0:h.result,c=M(B,{type:"binary"});for(const s in c.Sheets)if(c.Sheets.hasOwnProperty(s)){r=T.sheet_to_json(c.Sheets[s]);break}r.forEach(s=>{var m;s.itemId=S,s.gender=s.gender==="男"?1:2,s.createId=(m=D.userInfo)==null?void 0:m.id}),I(r)},o.readAsBinaryString(t),!1},fileList:N},v=(t,r)=>{w(t),y(r.name),j(r.name),n.length>0&&n.map(o=>{o.itemId=t})},R=[{title:"性别",dataIndex:"gender",align:"center",width:80,render:t=>F(t)},{title:"年龄/年级",dataIndex:"stage",align:"center",width:100},{title:"序号",dataIndex:"serialNumber",align:"center",width:100},{title:"起始值",dataIndex:"startValue",align:"center",width:100},{title:"结束值",dataIndex:"endValue",align:"center",width:100},{title:"结论",dataIndex:"conclusion",align:"center",width:100}];return e.jsxs("div",{className:"main-content",children:[g,e.jsx("div",{className:"form-content",children:e.jsxs(H,{className:O.row,align:"middle",children:[e.jsx(l,{span:2,children:"体检项目："}),e.jsx(l,{span:7,children:e.jsx(P,{showSearch:!0,placeholder:"请选择",className:"select-width",options:u("1826815637926842368"),value:d,onChange:v})}),e.jsx(l,{span:8}),e.jsxs(l,{span:7,style:{display:"flex",textAlign:"right"},children:[e.jsxs(V,{...C,children:[e.jsx(x,{icon:p("ImportOutlined"),type:"primary",children:"导入文件"}),"  "]}),e.jsxs(x,{icon:p("ProfileOutlined"),type:"default",children:["  ",e.jsx("a",{download:!0,href:"../public/评分标准导入模版.xlsx",children:" 导入模板 "})]})]})]})}),e.jsx(U,{columns:R,dataSource:n,bordered:!0,footer:()=>e.jsx("span",{style:{color:"#ff0000"},children:"备注：导入前，请下载模板，学生信息按照模板整理好以后，请先选择体检项目，再上传excel文件"}),scroll:{y:400,x:500},pagination:!1})]})};export{G as default};
