import{r as l,F as a,s as q,bo as T,bp as R,j as e,R as w,C as d,I as o,i as c,bq as C,br as F,aR as S}from"./index-Da2ZG1xd.js";import{T as v}from"./index-5IsStPVA.js";const k=t=>{l.useImperativeHandle(t.onRef,()=>({confirm:g}));const[r]=a.useForm(),[u,j]=q.useMessage(),[m,h]=l.useState(""),[p,x]=l.useState("");l.useEffect(()=>{I()},[]);const I=()=>{const s=t.data;x(s.questionnaireTypeId),s.id!==void 0&&s.id!==null&&s.id!==""?(h(s.id),x(s.questionnaireTypeId),r.setFieldsValue(s)):(h(""),r.setFieldsValue({serialNumber:s.serialNumber,options:[{serialNumber:1,description:"没有(根本不/从来没有) "},{serialNumber:2,description:"很少(有一点/偶尔)"},{serialNumber:3,description:"有时(有些/少数时间)"},{serialNumber:4,description:"经常(相当/多数时间)"},{serialNumber:5,description:"总是(非常/每天)"}]}))},g=()=>{r.validateFields().then(s=>{console.log(s),m!==""?(s.id=m,s.questionnaireTypeId=p,y(s)):(s.questionnaireTypeId=p,b(s))}).catch(s=>{})},b=async s=>{t.setLoading(!0);let i=await T(s);(i==null?void 0:i.status)===200&&(u.success(i.message),t.closeModal()),t.setLoading(!1)},y=async s=>{let i=await R(s);(i==null?void 0:i.status)===200&&(u.success(i.message),t.closeModal())};return e.jsxs("div",{className:"form-content",children:[j,e.jsx(a,{form:r,children:e.jsxs(w,{children:[e.jsx(d,{span:24,children:e.jsx(a.Item,{label:"序号",name:"serialNumber",rules:[{required:!0,message:"序号不能为空"}],children:e.jsx(v,{min:0,className:"input-width",placeholder:"请输入"})})}),e.jsx(d,{span:24,children:e.jsx(a.Item,{label:"问题",name:"description",rules:[{required:!0,message:"问题不能为空"}],children:e.jsx(o,{min:0,className:"input-width",placeholder:"请输入"})})}),e.jsx(d,{span:24,children:e.jsx(a.Item,{label:"选择类型",name:"selectType",rules:[{required:!0,message:"选择类型不能为空"}],children:e.jsxs(c.Group,{children:[e.jsx(c,{value:1,children:"单选题"}),e.jsx(c,{value:2,children:"多选题"})]})})}),e.jsx(a.List,{name:"options",children:(s,{add:i,remove:f},{errors:E})=>e.jsx("div",{children:s.map((n,N)=>e.jsx(a.Item,{label:"选项",required:!0,children:e.jsxs(C,{children:[e.jsx(a.Item,{noStyle:!0,validateTrigger:["onChange","onBlur"],name:[n.name,"serialNumber"],rules:[{required:!0,message:"选项序号不能为空"}],children:e.jsx(o,{style:{width:40},placeholder:"序号"})}),e.jsx(a.Item,{noStyle:!0,validateTrigger:["onChange","onBlur"],name:[n.name,"description"],rules:[{required:!0,message:"选项内容不能为空"}],children:e.jsx(o,{style:{width:310},placeholder:"选项内容"})}),s.length-1===N?e.jsx(F,{title:"新增",onClick:()=>{i()}}):e.jsx(S,{title:"删除",onClick:()=>{f(n.name)}})]},n.key)}))})})]})})]})};export{k as default};
